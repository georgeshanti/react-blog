<p>I don't know how many people know this but you can host websites, servers, network storage and all the good stuff you see on that internet right from your tiny bedroom. How do you think Larry Page and Sergey Brin did it back in 1998.</p>
<img src="/blog/posts/hosting-a-server-at-home-04/server.jpg" /><br/>
<i>The first Google computer at Stanford was housed in custom-made enclosures constructed from Lego bricks.</i><br/><br/>
<p>So pre-2006 there weren't really big cloud platform providers like there now like AWS, GCP, Heroku, Digital Ocean and the other flavours of the cloud. Sure AWS started sometime in 2002, but they didn't really get any traction till 2006. There was no cloud back then, they were all physical servers to everyone. If you wanted to host any content on the internet, you'd have to call up some provider of a server-farm or mainframe and ask them for a dedicated machine or vm and a dedicated ip.</p>
<p>So picture you're a young Larry Page, and you and your friend want to host a search engine for the web. You're college kids and don't have any money to afford a server. So what do you do? You run your server on your personal desktop and connect that to the internet. Voila! You saved all those <i>$$$</i> that you don't have.</p>
<p>It sounds simple and it really is. I assume all of you could easily just spawn a computing instance on any cloud platform and spin up a webserver on it easily and start serving content. So I could just tell you how to do  this same thing on your home PC and you could do it yourself but then you wouldn't know what it is that you did. So I'll try and explain as we go along. This is gonna get a little technical.</p><br/>
<h2>Let's Begin</h2>
<h5>1. How internet network communication works</h5>
<img src="/blog/posts/hosting-a-server-at-home-04/network.jpg" />
<p>Clients(your browsers and apps) establish connections with servers(servers) over a network called the Internet Protocol network, IP network and everyone on this network has a unique IP address. So when you try to establish a communication channel with someone over the internet you send them an IP packet. Now this packet has a bunch of stuff in it but the two things we need to know about are the Source and Destination IP address. As your IP packet bounces from machine to machine, each one looks at the destination IP address and decides where to bounce your packet off to next until finally the machine with the specified destination IP address gets it. The purpose of the source IP address is to let the destination machine know where the packet came from so that if it wants to send data back, it knows where to send it back to. Now machines need to be able to accept and establish multiple connections at the same time so it provides a interface called ports and each port has a port number and when you send a packet you also specify the source and destination port numbers.(this is not in the IP level but the TCP/UDP level but since the network is actually a TCP/IP network they are actually coupled quite tightly, this is for a later blog post).</p>
<p>Summary: To communicate we send IP packets specifying the source and destination IP addresses and ports to establish a two way communication channel. All traffic on the internet travels over the IP network using IP packets. This include HTTP requests and responses which is what web-servers use.</p><br/>
<h5>2. What Network Address Translators are - NAT</h5>
<img src="/blog/posts/hosting-a-server-at-home-04/nat.jpg" /><br/><br/>
<p>You can look up what NATs are on wikipedia but I'll explain what a NAT does practically at your home.</p>
<p>So when you are sitting at home on your laptop browsing the internet, there are two networks at play here. You local private network ie. you WiFi/LAN and the wide area public network ie. the Internet. So when you connect to good old Google. You are requesting the connection from inside your private network to a server out in the public network. So when you send an IP packet, there is the question of how does the Google server know that it has to reply to your laptop in your private network when there could be so many machines out there that have the same IP address(192.168.*.*) in their own private network. You can't just send 192.168.1.2 to Google. Google doesn't know where that is. This is where the magic of NATs come in.</p>
<p>NATs are Network Address Translators and you will understand the name very soon. NATs sit at the edge of a network to facilate traffic in and out of the network. So when you establish a connection from your laptop to Google, you are actualy going through your router, which is a NAT. The NAT(router) will take note of your local IP address and local port before sending that same IP packet off to Google but with the NAT's public IP address and a public port that it decides. So when Google gets this IP packet it sees the source IP address as a public one on the public IP network, Google knows it can send packets back to that public IP and that public port. So Google responds with an IP packet back to the source IP address and port. Your NAT gets this packet and it knows that packets that were sent from this port came from your local IP and local port. So it knows that when packets come back to it's own specific public port it has to go back to your laptop's local IP and local port.</p>
<p>So NATs translate your network's private IP addresses and ports into it's own public IP address and ports. The purpose of NATs was to assign several machines to network that had a single IP address. So all these machines would have the same IP adress and we can save up on IP addresses so we don't run out of them. So servers outside these networks needn't worry about which machine it has to communicate to, it just knows that it has to communicate to the NAT and the NAT can figure out the rest.</p>
<h5>3. Hosting a server at home</h5>
<p>So there are different types of NATs - strict, moderate and open. We'll start with the usual NAT. Let's imagine your ISP gives you a moderate NAT. These NATs do not do network address translations for connections coming from outside the private network. Instead what it does allow for are network address translations for connections originating from inside the private network. It also does network address translations for packets from outside the private network that are part of a connection that originated from within the private network. What this means is that you can make requests from your network to the internet and get responses for those same requests. But what this also means is that requests cannot be made from outside the private network into the priavte network. So you cannot host a webserver and accept requests to that server from outside your private network.</p>
<p>Now let's say your ISP is nice enough to give you an open NAT, like Airtel did for us. So open NATs do network address translations both ways. Both into and out of the private network, this means that connections can be established into the private network from outside the private network. So you can host a webserver on your laptop and accept connections from outside the network. But wait a minute. NATs can figure out how to translate packets for connections that were established inside the network, but how does it know how to translate the address for connections that come from outside the network. How does it know which machine in the network the connection needs to to be established with. This is where NATs give you port forwarding. You can setup a port forward through your router's webpage to forward one port of the NAT to a specific private IP address and port on the private network. So all packets coming to that port on the NAT will be forwarded to the private IP address and port specified.</p><br/>
<p>Let's take a look at an example. Let's say you host a website on your laptop at port 8000. And you laptop's private IP address is 192.168.1.9 and your pubic IP address(public IP address of NAT/router) is 234.64.96.749. If you setup a port forward in your router from port 3000 on the router/NAT to port 8000 on IP address 192.168.1.9, then you can access your web server remotely from any device using 234.64.96.749:3000</p><br/>
<p style="text-align: center;"><i>234.64.96.749:3000 --> 192.168.1.9:8000</i></p>